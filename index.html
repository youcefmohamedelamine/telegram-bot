<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=no">
<meta name="description" content="Ù…ØªØ¬Ø± Ø§Ù„Ù„Ø§Ø´ÙŠØ¡ - Ø§Ù…ØªÙ„Ùƒ Ø§Ù„Ø¹Ø¯Ù… Ø¨Ø£ÙØ¶Ù„ Ø§Ù„Ø£Ø³Ø¹Ø§Ø±">
<title>Ù…ØªØ¬Ø± Ø§Ù„Ù„Ø§Ø´ÙŠØ¡</title>
<script src="https://telegram.org/js/telegram-web-app.js"></script>
<style>
*{margin:0;padding:0;box-sizing:border-box}
body{font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,'Helvetica Neue',Arial,sans-serif;background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);min-height:100vh;color:white;overflow-x:hidden;padding-bottom:20px}
.container{max-width:500px;margin:0 auto;padding:20px}
.header{text-align:center;padding:30px 0 20px;animation:fadeInDown .8s}
.header h1{font-size:2.2em;margin-bottom:10px;text-shadow:2px 2px 4px rgba(0,0,0,.3)}
.header .subtitle{font-size:1em;opacity:.9}
.profile-card{background:rgba(255,255,255,.15);backdrop-filter:blur(10px);border-radius:20px;padding:20px;margin:20px 0;box-shadow:0 8px 32px rgba(0,0,0,.1);animation:fadeInUp .8s}
.profile-header{display:flex;align-items:center;gap:15px;margin-bottom:15px}
.avatar{width:60px;height:60px;border-radius:50%;background:linear-gradient(135deg,#f093fb 0%,#f5576c 100%);display:flex;align-items:center;justify-content:center;font-size:1.8em;box-shadow:0 4px 15px rgba(0,0,0,.2)}
.profile-info h2{font-size:1.3em;margin-bottom:5px;word-wrap:break-word;max-width:300px}
.rank-badge{display:inline-block;background:rgba(255,255,255,.25);padding:4px 12px;border-radius:20px;font-size:.85em}
.stats{display:grid;grid-template-columns:repeat(2,1fr);gap:12px;margin-top:15px}
.stat-item{background:rgba(255,255,255,.1);padding:12px;border-radius:12px;text-align:center}
.stat-value{font-size:1.5em;font-weight:bold;display:block;margin-bottom:3px}
.stat-label{font-size:.85em;opacity:.8}
.rank-progress{margin:20px 0;animation:fadeInUp 1s}
.progress-bar{background:rgba(255,255,255,.2);height:25px;border-radius:15px;overflow:hidden;margin-bottom:8px}
.progress-fill{background:linear-gradient(90deg,#f093fb 0%,#f5576c 100%);height:100%;transition:width 1s ease;display:flex;align-items:center;justify-content:center;font-weight:bold;font-size:.9em;min-width:40px}
.next-rank{text-align:center;font-size:.95em;opacity:.9}
.products-section{margin:25px 0;animation:fadeInUp 1s}
.section-title{font-size:1.6em;margin-bottom:18px;text-align:center;font-weight:bold}
.product-grid{display:grid;gap:18px}
.product-card{background:rgba(255,255,255,.15);backdrop-filter:blur(10px);border-radius:18px;padding:20px;box-shadow:0 8px 32px rgba(0,0,0,.1);transition:transform .3s,box-shadow .3s}
.product-card:active{transform:scale(.98)}
.product-icon{font-size:2.5em;text-align:center;margin-bottom:12px}
.product-name{font-size:1.3em;font-weight:bold;margin-bottom:8px;text-align:center}
.product-description{text-align:center;opacity:.9;margin-bottom:15px;font-size:.95em}
.price-options{display:flex;gap:8px;justify-content:center;flex-wrap:wrap}
.price-btn{background:rgba(255,255,255,.3);border:2px solid rgba(255,255,255,.5);padding:10px 18px;border-radius:12px;color:white;font-weight:bold;cursor:pointer;transition:all .3s;font-size:.95em}
.price-btn:active{background:rgba(255,255,255,.5);transform:scale(.95)}
.price-btn:disabled{opacity:.5;cursor:not-allowed}
.error-message{background:rgba(255,0,0,.2);border:2px solid rgba(255,0,0,.5);border-radius:12px;padding:15px;margin:20px 0;text-align:center;display:none}
.error-message.show{display:block;animation:shake .5s}
@keyframes fadeInDown{from{opacity:0;transform:translateY(-30px)}to{opacity:1;transform:translateY(0)}}
@keyframes fadeInUp{from{opacity:0;transform:translateY(30px)}to{opacity:1;transform:translateY(0)}}
@keyframes shake{0%,100%{transform:translateX(0)}25%{transform:translateX(-10px)}75%{transform:translateX(10px)}}
</style>
</head>
<body>
<div class="container">
<div class="header floating">
<h1>ğŸŒŸ Ù…ØªØ¬Ø± Ø§Ù„Ù„Ø§Ø´ÙŠØ¡ ğŸŒŸ</h1>
<p class="subtitle">Ø§Ù…ØªÙ„Ùƒ Ø§Ù„Ø¹Ø¯Ù… Ø¨Ø£ÙØ¶Ù„ Ø§Ù„Ø£Ø³Ø¹Ø§Ø±</p>
</div>
<div class="error-message" id="errorMessage">âŒ Ø­Ø¯Ø« Ø®Ø·Ø£! Ø­Ø§ÙˆÙ„ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰</div>
<div class="profile-card">
<div class="profile-header">
<div class="avatar">ğŸ‘¤</div>
<div class="profile-info">
<h2 id="userName">Ù…Ø±Ø­Ø¨Ø§Ù‹</h2>
<span class="rank-badge" id="userRank">ğŸŒ± Ø²Ø§Ø¦Ø± Ø¬Ø¯ÙŠØ¯</span>
</div>
</div>
<div class="stats">
<div class="stat-item"><span class="stat-value" id="totalSpent">0</span><span class="stat-label">â­ Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø¥Ù†ÙØ§Ù‚</span></div>
<div class="stat-item"><span class="stat-value" id="orderCount">0</span><span class="stat-label">ğŸ“¦ Ø§Ù„Ø·Ù„Ø¨Ø§Øª</span></div>
</div>
</div>
<div class="rank-progress">
<div class="progress-bar">
<div class="progress-fill" id="progressBar" style="width:0%"><span id="progressText">0%</span></div>
</div>
<p class="next-rank" id="nextRank">ğŸ¯ Ø§Ù„Ù„Ù‚Ø¨ Ø§Ù„Ù‚Ø§Ø¯Ù…: Ù…Ø¨ØªØ¯Ø¦ Ø§Ù„Ù„Ø§Ø´ÙŠØ¡</p>
</div>
<div class="products-section">
<h2 class="section-title">ğŸ›ï¸ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª Ø§Ù„Ù…ØªØ§Ø­Ø©</h2>
<div class="product-grid">
<div class="product-card"><div class="product-icon">ğŸ”¹</div><div class="product-name">Ù„Ø§Ø´ÙŠØ¡ ØµØºÙŠØ±</div><p class="product-description">Ù…Ø«Ø§Ù„ÙŠ Ù„Ù„Ù…Ø¨ØªØ¯Ø¦ÙŠÙ†</p><div class="price-options"><button class="price-btn" onclick="buyProduct('small',5000)">5K â­</button><button class="price-btn" onclick="buyProduct('small',10000)">10K â­</button><button class="price-btn" onclick="buyProduct('small',15000)">15K â­</button></div></div>
<div class="product-card"><div class="product-icon">ğŸ”·</div><div class="product-name">Ù„Ø§Ø´ÙŠØ¡ Ù…ØªÙˆØ³Ø·</div><p class="product-description">Ø§Ù„Ø£ÙƒØ«Ø± Ø´Ø¹Ø¨ÙŠØ©</p><div class="price-options"><button class="price-btn" onclick="buyProduct('medium',20000)">20K â­</button><button class="price-btn" onclick="buyProduct('medium',30000)">30K â­</button><button class="price-btn" onclick="buyProduct('medium',40000)">40K â­</button></div></div>
<div class="product-card"><div class="product-icon">ğŸ’ </div><div class="product-name">Ù„Ø§Ø´ÙŠØ¡ ÙƒØ¨ÙŠØ±</div><p class="product-description">Ù„Ù„Ù…Ø­ØªØ±ÙÙŠÙ† ÙÙ‚Ø·</p><div class="price-options"><button class="price-btn" onclick="buyProduct('large',50000)">50K â­</button><button class="price-btn" onclick="buyProduct('large',75000)">75K â­</button><button class="price-btn" onclick="buyProduct('large',100000)">100K â­</button></div></div>
</div></div></div>

<script>
let tg=null,isInitialized=false,purchaseInProgress=false;
const PRODUCTS={small:{name:'ğŸ”¹ Ù„Ø§Ø´ÙŠØ¡ ØµØºÙŠØ±',emoji:'ğŸ”¹'},medium:{name:'ğŸ”· Ù„Ø§Ø´ÙŠØ¡ Ù…ØªÙˆØ³Ø·',emoji:'ğŸ”·'},large:{name:'ğŸ’  Ù„Ø§Ø´ÙŠØ¡ ÙƒØ¨ÙŠØ±',emoji:'ğŸ’ '}};
const VALID_PRICES={small:[5000,10000,15000],medium:[20000,30000,40000],large:[50000,75000,100000]};
const RANKS=[{threshold:500000,name:'ğŸ‘‘ Ø¥Ù…Ø¨Ø±Ø§Ø·ÙˆØ± Ø§Ù„Ø¹Ø¯Ù…'},{threshold:300000,name:'ğŸ’ Ù…Ù„Ùƒ Ø§Ù„Ù„Ø§Ø´ÙŠØ¡'},{threshold:200000,name:'ğŸ† Ø£Ù…ÙŠØ± Ø§Ù„ÙØ±Ø§Øº'},{threshold:100000,name:'â­ Ù†Ø¨ÙŠÙ„ Ø§Ù„Ø¹Ø¯Ù…'},{threshold:50000,name:'ğŸŒŸ ÙØ§Ø±Ø³ Ø§Ù„Ù„Ø§Ø´ÙŠØ¡'},{threshold:20000,name:'âœ¨ ØªØ§Ø¬Ø± Ø§Ù„Ø¹Ø¯Ù…'},{threshold:10000,name:'ğŸ¯ Ù…Ø¨ØªØ¯Ø¦ Ø§Ù„Ù„Ø§Ø´ÙŠØ¡'},{threshold:0,name:'ğŸŒ± Ø²Ø§Ø¦Ø± Ø¬Ø¯ÙŠØ¯'}];
const BOT_USERNAME='WinterLand_bot';

function showError(m){const e=document.getElementById('errorMessage');if(e){e.textContent=m||'âŒ Ø­Ø¯Ø« Ø®Ø·Ø£! Ø­Ø§ÙˆÙ„ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰';e.classList.add('show');setTimeout(()=>e.classList.remove('show'),3000)}}
function sanitizeText(t,m=100){if(typeof t!=='string')return'Ù…Ø³ØªØ®Ø¯Ù…';t=t.trim();if(t.length>m)t=t.substring(0,m);const d=document.createElement('div');d.textContent=t;return d.textContent||'Ù…Ø³ØªØ®Ø¯Ù…'}
function formatNumber(n){const x=parseInt(n);return isNaN(x)?'0':x.toLocaleString('ar-EG')}
function getUserTitle(s){const x=parseInt(s)||0;for(let r of RANKS)if(x>=r.threshold)return r.name;return RANKS[RANKS.length-1].name}
function validatePrice(c,a){if(!c||!VALID_PRICES[c])return false;const p=parseInt(a);return !isNaN(p)&&VALID_PRICES[c].includes(p)}
function safeSetText(id,t){const e=document.getElementById(id);if(e)e.textContent=sanitizeText(String(t))}
function updateUserInterface(d){if(!d||typeof d!=='object')return;const s=parseInt(d.totalSpent)||0,o=parseInt(d.orderCount)||0;safeSetText('totalSpent',formatNumber(s));safeSetText('orderCount',formatNumber(o));safeSetText('userRank',getUserTitle(s));updateProgressBar(s)}
function updateProgressBar(s){const spent=parseInt(s)||0;let next=null;for(let r of RANKS)if(spent<r.threshold)next=r;const bar=document.getElementById('progressBar'),txt=document.getElementById('progressText'),nxt=document.getElementById('nextRank');if(!bar||!txt||!nxt)return;if(next){const p=Math.min(100,(spent/next.threshold)*100);bar.style.width=p+'%';txt.textContent=Math.round(p)+'%';nxt.textContent=`ğŸ¯ Ø§Ù„Ù„Ù‚Ø¨ Ø§Ù„Ù‚Ø§Ø¯Ù…: ${next.name}`}else{bar.style.width='100%';txt.textContent='100%';nxt.textContent='ğŸ‰ ÙˆØµÙ„Øª Ù„Ø£Ø¹Ù„Ù‰ Ù„Ù‚Ø¨!'}}
function buyProduct(c,a){if(purchaseInProgress)return showError('â³ Ø¬Ø§Ø±ÙŠ Ù…Ø¹Ø§Ù„Ø¬Ø© Ø·Ù„Ø¨Ùƒ...');if(!PRODUCTS[c]||!validatePrice(c,a))return showError('âŒ Ø¨ÙŠØ§Ù†Ø§Øª ØºÙŠØ± ØµØ­ÙŠØ­Ø©');if(!tg||!isInitialized)return showError('âŒ Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨ØªÙŠÙ„ÙŠØ¬Ø±Ø§Ù…');purchaseInProgress=true;try{tg.HapticFeedback?.impactOccurred('medium')}catch{}const p=PRODUCTS[c],pr=(a/1000).toFixed(0)+'K';try{tg.showPopup?tg.showPopup({title:'ğŸ’« ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø´Ø±Ø§Ø¡',message:`${p.emoji} ${p.name}\nğŸ’° Ø§Ù„Ø³Ø¹Ø±: ${pr} â­\n\nØ³ÙŠØªÙ… ÙØªØ­ Ù†Ø§ÙØ°Ø© Ø§Ù„Ø¯ÙØ¹`,buttons:[{id:'buy',type:'default',text:'âœ… Ù…ØªØ§Ø¨Ø¹Ø©'},{id:'cancel',type:'cancel',text:'âŒ Ø¥Ù„ØºØ§Ø¡'}]},b=>{b==='buy'?openInvoice(c,a):purchaseInProgress=false}):openInvoice(c,a)}catch{openInvoice(c,a)}}
function openInvoice(c,a){try{const link=`https://t.me/${BOT_USERNAME}?start=buy_${c}_${a}`;try{tg.close();tg.openLink?tg.openLink(link):tg.openTelegramLink?tg.openTelegramLink(link):window.location.href=link}catch{showError('âŒ Ø®Ø·Ø£ ÙÙŠ ÙØªØ­ Ø§Ù„Ø¨ÙˆØª')}setTimeout(()=>purchaseInProgress=false,2000)}catch{purchaseInProgress=false}}
function handleRefresh(){try{tg.HapticFeedback?.impactOccurred('light');location.reload()}catch{showError('âŒ Ø®Ø·Ø£ ÙÙŠ Ø§Ù„ØªØ­Ø¯ÙŠØ«')}}
function handleBack(){try{tg?.close?tg.close():window.history.back()}catch{}}
function setupButtons(){if(!tg)return;try{tg.MainButton&&(tg.MainButton.setText('ğŸ”„ ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª'),tg.MainButton.show(),tg.MainButton.onClick(handleRefresh))}catch{}try{tg.BackButton&&(tg.BackButton.show(),tg.BackButton.onClick(handleBack))}catch{}}
function initTelegram(){if(!window.Telegram||!window.Telegram.WebApp){showError('âŒ Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚');return false}tg=window.Telegram.WebApp;tg.expand();try{tg.setHeaderColor?.('#667eea');tg.setBackgroundColor?.('#667eea')}catch{}isInitialized=true;return true}
function loadUserData(){if(!tg)return updateUserInterface({totalSpent:0,orderCount:0});const u=tg.initDataUnsafe?.user;if(u?.first_name)safeSetText('userName',u.first_name);try{const s=tg.initDataUnsafe?.start_param;if(s){const d=JSON.parse(atob(s));if(d&&typeof d==='object'){updateUserInterface(d);return}}}catch{}updateUserInterface({totalSpent:0,orderCount:0})}
function initApp(){if(!initTelegram())return;loadUserData();setupButtons()}
document.readyState==='loading'?document.addEventListener('DOMContentLoaded',initApp):initApp();
</script>
</body>
</html>
