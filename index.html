<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù…ØªØ¬Ø± Ø§Ù„Ù†Ø¬ÙˆÙ… â­</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        /* ØªÙ†Ø³ÙŠÙ‚ CSS Ø£Ø³Ø§Ø³ÙŠ ÙŠØªÙ†Ø§Ø³Ø¨ Ù…Ø¹ Ù…Ø¸Ù‡Ø± ØªÙŠÙ„ÙŠØ¬Ø±Ø§Ù… */
        body {
            font-family: -apple-system, sans-serif;
            /* Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø£Ù„ÙˆØ§Ù† Ù…ØªØºÙŠØ±Ø© Ù…Ù† ØªÙŠÙ„ÙŠØ¬Ø±Ø§Ù… (Ù…ÙˆØµÙ‰ Ø¨Ù‡) */
            background-color: var(--tg-theme-bg-color, #f4f4f5);
            color: var(--tg-theme-text-color, #111827);
            padding: 20px;
            min-height: 100vh;
            margin: 0;
            transition: background-color 0.3s;
        }
        .container { max-width: 500px; margin: 0 auto; }
        .header { text-align: center; padding-bottom: 20px; }
        .product {
            background-color: var(--tg-theme-secondary-bg-color, #ffffff);
            border-radius: 15px;
            padding: 15px;
            margin: 15px 0;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
        }
        .product h2 { margin: 0 0 10px 0; font-size: 1.25rem; }
        .price-group { display: flex; flex-wrap: wrap; gap: 10px; margin-top: 10px;}
        button {
            /* Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø²Ø± ÙŠØªÙ…Ø§Ø´Ù‰ Ù…Ø¹ Ø£Ù„ÙˆØ§Ù† ØªÙŠÙ„ÙŠØ¬Ø±Ø§Ù… */
            background-color: var(--tg-theme-button-color, #007aff);
            border: none;
            padding: 10px 15px;
            border-radius: 10px;
            color: var(--tg-theme-button-text-color, #ffffff);
            cursor: pointer;
            font-size: 14px;
            flex-grow: 1;
        }
        button.selected {
            /* ØªÙ…ÙŠÙŠØ² Ø§Ù„Ø²Ø± Ø§Ù„Ù…Ø®ØªØ§Ø± */
            opacity: 0.7;
            border: 2px solid var(--tg-theme-hint-color, #9ca3af);
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>â­ Ù…ØªØ¬Ø± Ø§Ù„Ù†Ø¬ÙˆÙ… â­</h1>
            <p>Ø§Ø®ØªØ± Ù…Ù†ØªØ¬Ø§Ù‹ Ù„Ø¥ØªÙ…Ø§Ù… Ø¹Ù…Ù„ÙŠØ© Ø§Ù„Ø´Ø±Ø§Ø¡ Ø¨Ù†Ø¬ÙˆÙ… ØªÙŠÙ„ÙŠØ¬Ø±Ø§Ù….</p>
        </div>
        
        <div class="product">
            <h2>âœ¨ Ø­Ø²Ù…Ø© Ø§Ù„Ù†Ø¬Ù… Ø§Ù„ØµØºÙŠØ±</h2>
            <p>Ù„Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø¨Ø¯Ø§ÙŠØ© Ù…Ø´Ø±Ù‚Ø©.</p>
            <div class="price-group">
                <button data-category="small" data-amount="5000">5,000 â­</button>
            </div>
        </div>
        
        <div class="product">
            <h2>ğŸ’« Ø­Ø²Ù…Ø© Ø§Ù„Ù†Ø¬Ù… Ø§Ù„Ù…ØªÙˆØ³Ø·</h2>
            <p>Ù„Ù„Ù…ÙŠØ²Ø§Øª Ø§Ù„Ø£ÙƒØ«Ø± Ø´Ø¹Ø¨ÙŠØ©.</p>
            <div class="price-group">
                <button data-category="medium" data-amount="15000">15,000 â­</button>
            </div>
        </div>
        
        <div class="product">
            <h2>ğŸŒŸ Ø­Ø²Ù…Ø© Ø§Ù„Ù†Ø¬Ù… Ø§Ù„Ø°Ù‡Ø¨ÙŠ</h2>
            <p>Ù„Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…ÙŠØ²Ø§Øª Ø§Ù„Ø§Ø­ØªØ±Ø§ÙÙŠØ©.</p>
            <div class="price-group">
                <button data-category="large" data-amount="50000">50,000 â­</button>
            </div>
        </div>
    </div>
    
    <script>
        // ØªÙ‡ÙŠØ¦Ø© ÙˆØ§Ø¬Ù‡Ø© ØªÙŠÙ„ÙŠØ¬Ø±Ø§Ù…
        const tg = window.Telegram.WebApp;

        // ÙØ­Øµ Ø³Ø±ÙŠØ¹: ÙŠØ¬Ø¨ Ø£Ù† ÙŠØ¹Ù…Ù„ Ù‡Ø°Ø§ Ø§Ù„ÙƒÙˆØ¯ Ø¯Ø§Ø®Ù„ ØªÙŠÙ„ÙŠØ¬Ø±Ø§Ù…
        if (!tg) {
            document.body.innerHTML = '<div style="text-align:center;padding:50px;">ÙŠØ¬Ø¨ ØªØ´ØºÙŠÙ„ Ù‡Ø°Ø§ Ø§Ù„Ù…ØªØ¬Ø± Ø¯Ø§Ø®Ù„ ØªØ·Ø¨ÙŠÙ‚ ØªÙŠÙ„ÙŠØ¬Ø±Ø§Ù….</div>';
            throw new Error('Not in Telegram');
        }

        let selected = null; // Ù„ØªØ®Ø²ÙŠÙ† Ø§Ù„Ù…Ù†ØªØ¬ Ø§Ù„Ù…Ø®ØªØ§Ø±

        // ØªØ¬Ù‡ÙŠØ² Ø§Ù„ÙˆØ§Ø¬Ù‡Ø©
        tg.ready();
        tg.expand();
        tg.MainButton.hide(); // Ø¥Ø®ÙØ§Ø¡ Ø²Ø± Ø§Ù„Ø´Ø±Ø§Ø¡ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ ÙÙŠ Ø§Ù„Ø¨Ø¯Ø§ÙŠØ©

        // ØªÙØ¹ÙŠÙ„ Ø£Ù„ÙˆØ§Ù† Ø®Ù„ÙÙŠØ© ÙˆØ²Ø± Ø§Ù„Ø¨ÙˆØª Ù„ØªØªÙ†Ø§Ø³Ø¨ Ù…Ø¹ Ø§Ù„Ù€ Web App
        try {
            tg.setHeaderColor('secondary_bg_color');
            tg.setBackgroundColor('bg_color');
        } catch (e) {
            console.warn("Couldn't set colors: ", e);
        }

        // Ø¥Ø¶Ø§ÙØ© Ù…Ø³ØªÙ…Ø¹ÙŠ Ø§Ù„Ø£Ø­Ø¯Ø§Ø« Ù„Ø£Ø²Ø±Ø§Ø± Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª
        document.querySelectorAll('button[data-amount]').forEach(btn => {
            btn.onclick = function() {
                const cat = this.dataset.category;
                const amt = parseInt(this.dataset.amount);
                
                // 1. Ù…Ø³Ø­ Ø§Ù„ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ø³Ø§Ø¨Ù‚ ÙˆØ¥Ø¶Ø§ÙØ© Ø§Ù„ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ø¬Ø¯ÙŠØ¯
                document.querySelectorAll('button').forEach(b => b.classList.remove('selected'));
                this.classList.add('selected');
                
                // 2. ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…Ù†ØªØ¬ Ø§Ù„Ù…Ø®ØªØ§Ø±
                selected = { category: cat, amount: amt };
                
                // 3. ØªØ­Ø¯ÙŠØ« Ø²Ø± ØªÙŠÙ„ÙŠØ¬Ø±Ø§Ù… Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ ÙˆØ¥Ø¸Ù‡Ø§Ø±Ù‡
                tg.MainButton.setText(`Ø´Ø±Ø§Ø¡ ${new Intl.NumberFormat('ar-EG').format(amt)} â­`);
                tg.MainButton.show();
                tg.MainButton.enable();
                
                // 4. Ø¥Ø¹Ø·Ø§Ø¡ Ø§Ù‡ØªØ²Ø§Ø² Ø®ÙÙŠÙ Ù„Ù„Ù…Ø³Ø© Ù†Ø§Ø¬Ø­Ø© (Haptic Feedback)
                if (tg.HapticFeedback) {
                    tg.HapticFeedback.impactOccurred('medium');
                }
            };
        });

        // Ù…Ø¹Ø§Ù„Ø¬ Ø§Ù„Ù†Ù‚Ø± Ø¹Ù„Ù‰ Ø²Ø± ØªÙŠÙ„ÙŠØ¬Ø±Ø§Ù… Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ (Ø§Ù„Ø²Ø± Ø§Ù„Ø³ÙÙ„ÙŠ)
        tg.MainButton.onClick(() => {
            if (selected) {
                // ØªØ¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙˆØ¥Ø±Ø³Ø§Ù„Ù‡Ø§ Ø¥Ù„Ù‰ Ø§Ù„Ø¨ÙˆØª (ÙƒÙˆØ¯ Python)
                const data = JSON.stringify({
                    action: 'buy',
                    category: selected.category,
                    amount: selected.amount
                });
                
                // Ù‡Ø°Ø§ Ù‡Ùˆ Ù…ÙØªØ§Ø­ Ø§Ù„Ø¹Ù…Ù„ÙŠØ©: Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¥Ù„Ù‰ Ù…Ø¹Ø§Ù„Ø¬ WebApp ÙÙŠ Ø§Ù„Ø¨ÙˆØª
                tg.sendData(data); 
            }
        });
    </script>
</body>
</html>
